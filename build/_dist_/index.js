function O(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function C(e,t,r){return r={path:t,exports:{},require:function(n,o){return x(n,o??r.path)}},e(r,r.exports),r.exports}function x(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}var D=C(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r;(function(o){o.typeOfFunction="function",o.boolTrue=!0})(r||(r={}));function n(o,i,s){if(!s||typeof s.value!==r.typeOfFunction)throw new TypeError("Only methods can be decorated with @bind. <"+i+"> is not a method!");return{configurable:r.boolTrue,get:function(){var m=s.value.bind(this);return Object.defineProperty(this,i,{value:m,configurable:r.boolTrue,writable:r.boolTrue}),m}}}t.bind=n,t.default=n}),T=O(D),a=T;var u=class{next(t){this.subscriber?.next?.(t)}completed(){this.subscriber?.completed?.()}subscribe(t){this.subscriber=t}};function p(e,t){let r=(t??document).querySelector(e);if(!r)throw Error(`No element ${e}`);return r}function w(e){return{do:t=>{if(e!=null)return t(e)}}}var f=new u;function v(e){f.next(e)}var M=Object.defineProperty,S=Object.getOwnPropertyDescriptor,d=(e,t,r,n)=>{for(var o=n>1?void 0:n?S(t,r):t,i=e.length-1,s;i>=0;i--)(s=e[i])&&(o=(n?s(t,r,o):s(o))||o);return n&&o&&M(t,r,o),o},h=class{constructor(){this.genericLUT={error:t=>this.error(t),warn:t=>this.warn(t),info:t=>this.info(t)}}error(t){console.error(t)}warn(t){console.warn(t)}info(t){console.info(t)}next(t){this.genericLUT[t.level](t.message)}};d([a],h.prototype,"error",1);d([a],h.prototype,"warn",1);d([a],h.prototype,"info",1);var E=Object.defineProperty,R=Object.getOwnPropertyDescriptor,b=(e,t,r,n)=>{for(var o=n>1?void 0:n?R(t,r):t,i=e.length-1,s;i>=0;i--)(s=e[i])&&(o=(n?s(t,r,o):s(o))||o);return n&&o&&E(t,r,o),o},c=class extends HTMLElement{constructor(t){super();this.tag=t,this.isDefined=!1,this.stylesheets=[];let n=p(`#${this.tag}`).content;this.attachShadow({mode:"open"}).appendChild(n.cloneNode(!0)),this.registerStylesheet("main.css"),customElements.whenDefined(this.tag).then(()=>{this.isDefined=!0;for(let o of this.stylesheets)this.setStylesheet(o);this.onDefined()})}setStylesheet(t){let r=document.createElement("link");r.setAttribute("rel","stylesheet"),r.setAttribute("href",t),this.shadowRoot?.appendChild(r)}registerStylesheet(t){this.isDefined?this.setStylesheet(t):this.stylesheets.push(t)}onDefined(){}connectedCallback(){v(this)}};b([a],c.prototype,"setStylesheet",1);b([a],c.prototype,"registerStylesheet",1);function l(e,t){return r=>{customElements.define(e,r,t)}}var L=Object.defineProperty,H=Object.getOwnPropertyDescriptor,I=(e,t,r,n)=>{for(var o=n>1?void 0:n?H(t,r):t,i=e.length-1,s;i>=0;i--)(s=e[i])&&(o=(n?s(t,r,o):s(o))||o);return n&&o&&L(t,r,o),o},_=class extends c{constructor(){super("view-render")}showView(e){}next(e){this.showView(e)}};_=I([l("view-render")],_);var A=Object.defineProperty,F=Object.getOwnPropertyDescriptor,U=(e,t,r,n)=>{for(var o=n>1?void 0:n?F(t,r):t,i=e.length-1,s;i>=0;i--)(s=e[i])&&(o=(n?s(t,r,o):s(o))||o);return n&&o&&A(t,r,o),o},g=class extends c{constructor(){super("game-canvas");this.state={position:{x:.5,y:.5},rotation:.15},document.addEventListener("keydown",e=>{switch(e.key){case"ArrowUp":this.forward();break;case"ArrowLeft":this.setRotation(this.state.rotation-.02);break;case"ArrowRight":this.setRotation(this.state.rotation+.02);break}})}init(e){this.ctx=this.getCtx(e),this.render(this.ctx)}getCtx(e){let t=e.getContext("2d");if(!t)throw"No rendering context";return t}render(e){let t=e.canvas;this.setWH(t),e.fillStyle="#000",e.fillRect(0,0,t.width,t.height),this.character(e),requestAnimationFrame(()=>this.render(e))}setWH(e){let{width:t,height:r}=e.getBoundingClientRect();e.width===t&&e.height===r||(e.width=t,e.height=r)}character(e){let t=this.state.position,{left:r,top:n}=this.vectorToCanvasCoords(e.canvas,t);e.strokeStyle="#15F",e.fillStyle="#15F",e.lineWidth=2,e.beginPath(),e.ellipse(r,n,20,20,0,0,Math.PI*2),e.stroke(),e.closePath();let o=new Path2D;o.moveTo(-5,-20),o.lineTo(5,-20),o.lineTo(0,20),o.lineTo(-5,-20),o.closePath(),e.setTransform(1,0,0,1,r,n),e.rotate((this.state.rotation*360-90)*Math.PI/180),e.fill(o),e.setTransform(1,0,0,1,0,0)}randomPosition(){return{x:Math.random(),y:Math.random()}}vectorToCanvasCoords(e,t){return{left:t.x*e.width,top:t.y*e.height}}setRotation(e){this.state.rotation=e}forward(){!this.ctx||(this.state.position.x=.005*Math.cos(this.state.rotation*360*Math.PI/180)+this.state.position.x,this.state.position.y=.005*(this.ctx.canvas.width/this.ctx.canvas.height)*Math.sin(this.state.rotation*360*Math.PI/180)+this.state.position.y)}connectedCallback(){w(this.shadowRoot).do(e=>this.init(p("canvas",e)))}};g=U([l("game-canvas")],g);function y(){let e=document.createElement("main");e.innerHTML=`
	<view-render>
		<game-canvas></game-canvas>
	</view-render>
	`,document.body.appendChild(e)}var q=Object.defineProperty,B=Object.getOwnPropertyDescriptor,N=(e,t,r,n)=>{for(var o=n>1?void 0:n?B(t,r):t,i=e.length-1,s;i>=0;i--)(s=e[i])&&(o=(n?s(t,r,o):s(o))||o);return n&&o&&q(t,r,o),o},j=class{static run(){new j}constructor(){f.subscribe({next:this.loadComponent}),this.logSystem=new h,y()}loadComponent(e){this.logSystem.next({level:"info",message:`Got component: ${e}`})}},P=j;N([a],P.prototype,"loadComponent",1);P.run();
/*
 web-component-decorator 1.1.0
 @copyright 2020 Edwin Martin
 @license MIT
 */
